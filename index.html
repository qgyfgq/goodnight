<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>仿 iPhone 主屏幕</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%237c3aed'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white'>📱</text></svg>" />
  <link rel="stylesheet" href="css/reset.css" />
  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/layout.css" />
  <link rel="stylesheet" href="css/components.css" />
  <link rel="stylesheet" href="css/xinliao/layout.css" />
  <link rel="stylesheet" href="css/xinliao/components.css" />
  <link rel="stylesheet" href="css/xinliao/panels.css" />
  <link rel="stylesheet" href="css/xinliao/messages.css" />
  <link rel="stylesheet" href="css/xinliao/chat.css" />
  <link rel="stylesheet" href="css/xinliao/moments.css" />
  <link rel="stylesheet" href="css/worldbook/layout.css" />
  <link rel="stylesheet" href="css/worldbook/components.css" />
  <link rel="stylesheet" href="css/settings.css" />
  <link rel="stylesheet" href="css/beautify.css" />
  <link rel="stylesheet" href="css/music/layout.css" />
  <link rel="stylesheet" href="css/music/search.css" />
  <link rel="stylesheet" href="css/home/layout.css" />
</head>
<body>
  <div class="page">
    <div class="device">
      <div class="widget-container">
        <div class="home-view" id="homeView">
          <div class="notch"></div>

        <section class="status-bar glass">
          <div class="avatar"></div>
          <div class="status-time" id="statusTime">--:--</div>
          <div class="battery-widget">
            <div class="battery-ring">
              <svg class="battery-progress" viewBox="0 0 100 100">
                <circle class="battery-circle" cx="50" cy="50" r="45"></circle>
              </svg>
              <div class="battery-content">
                <div class="battery-percentage" id="batteryPercentage">--</div>
                <div class="charging-icon" id="chargingIcon" style="display: none;">⚡</div>
              </div>
            </div>
          </div>
        </section>

        <section class="notebook-widget glass">
          <div class="notebook-page notebook-left">
            <div class="music-player">
              <div class="player-turntable">
              <div class="player-disc">
                  <div class="player-disc-inner"></div>
                </div>
                <div class="player-tonearm">
                  <div class="tonearm-base"></div>
                  <div class="tonearm-arm"></div>
                  <div class="tonearm-head"></div>
                </div>
              </div>
              <div class="player-controls">
                <button class="player-btn">⏮</button>
                <button class="player-btn active">▶</button>
                <button class="player-btn">⏭</button>
              </div>
              <div class="player-title">Now Playing</div>
            </div>
          </div>
          <div class="notebook-spine"></div>
          <div class="notebook-page notebook-right">
            <div class="notebook-photo-stack">
              <div class="notebook-photo-decor">
                <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop" alt="decorative photo">
              </div>
              <div class="notebook-photo" id="notebookPhoto">
                <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop" alt="notebook photo" id="photoImg">
              </div>
            </div>
          </div>
        </section>

        <section class="app-grid" id="appGrid"></section>

        <section class="dock glass" id="dock"></section>
        </div>

        <section class="settings-view glass" id="settingsView">
          <header class="settings-nav">
            <button class="settings-back" id="settingsBack" aria-label="返回">‹</button>
            <div class="settings-title" id="settingsTitle">设置</div>
          </header>

          <div class="settings-section settings-main active" id="settingsMain">
            <div class="settings-list">
              <button class="settings-item settings-link" id="apiSettingsEntry" aria-label="API 设置">
                <span class="settings-icon icon-api"></span>
                <span class="settings-text">API 设置</span>
              </button>
              <button class="settings-item settings-link" id="dataSettingsEntry" aria-label="数据管理">
                <span class="settings-icon icon-data"></span>
                <span class="settings-text">数据管理</span>
              </button>
              <button class="settings-item settings-link" id="soundSettingsEntry" aria-label="提示音设置">
                <span class="settings-icon icon-bell"></span>
                <span class="settings-text">提示音设置</span>
              </button>
              <div class="settings-item">
                <span class="settings-icon icon-voice"></span>
                <span class="settings-text">语音设置</span>
              </div>
            </div>
          </div>

          <div class="settings-section api-settings" id="apiSettings">
            <div class="settings-card">
              <div class="field">
                <label for="apiUrl">API 地址</label>
                <input id="apiUrl" type="text" placeholder="https://example.com" />
                <p class="field-hint">后缀已内置，无需再写 /v1</p>
              </div>

              <div class="field">
                <label for="apiKey">API 密钥</label>
                <input id="apiKey" type="password" placeholder="请输入密钥" />
              </div>

              <div class="field inline">
                <div class="field-group">
                  <label for="modelSelect">模型列表</label>
                  <select id="modelSelect">
                    <option value="">请先拉取模型</option>
                  </select>
                </div>
                <button class="btn secondary" id="btnFetchModels">拉取模型列表</button>
              </div>

              <div class="field inline">
                <div class="field-group">
                  <label>连接测试</label>
                  <div class="test-status" id="testStatus">未测试</div>
                </div>
                <button class="btn ghost" id="btnTest">测试连接</button>
              </div>

              <div class="field">
                <label for="profileSelect">已保存的配置</label>
                <div class="profile-select-row">
                  <select id="profileSelect" class="profile-select">
                    <option value="">-- 选择配置 --</option>
                  </select>
                  <button class="btn secondary" id="btnApplyProfile" type="button">应用</button>
                  <button class="btn ghost" id="btnDeleteProfile" type="button">删除</button>
                </div>
              </div>

              <div class="field inline with-popup">
                <div class="field-group">
                  <label>保存当前配置</label>
                  <p class="field-hint">将当前设置保存为新配置或覆盖已有配置</p>
                </div>
                <button class="btn primary" id="btnSave">保存配置</button>

                <div class="save-popup" id="savePopup" aria-hidden="true">
                  <div class="save-popup-card">
                    <label for="saveNameInput">配置名称</label>
                    <input id="saveNameInput" type="text" placeholder="例如：公司接口" />
                    <div class="save-actions">
                      <button class="btn ghost" id="btnSaveCancel" type="button">取消</button>
                      <button class="btn primary" id="btnSaveConfirm" type="button">保存</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="settings-section data-settings" id="dataSettings">
            <div class="data-settings-main active" id="dataSettingsMain">
              <div class="settings-list">
                <button class="settings-item settings-link" id="storageEntry" aria-label="存储空间">
                  <span class="settings-icon icon-storage"></span>
                  <span class="settings-text">存储空间</span>
                </button>
                <button class="settings-item settings-link" id="backupEntry" aria-label="数据备份">
                  <span class="settings-icon icon-backup"></span>
                  <span class="settings-text">数据备份</span>
                </button>
                <button class="settings-item settings-link" id="cleanEntry" aria-label="清理数据">
                  <span class="settings-icon icon-clean"></span>
                  <span class="settings-text">清理数据</span>
                </button>
              </div>
            </div>

            <div class="data-settings-detail" id="storageDetail">
              <div class="settings-card">
                <h3 class="settings-subtitle">📦 存储空间</h3>
                <div class="field">
                  <div class="storage-bar">
                    <div class="storage-bar-fill" id="storageBarFill"></div>
                  </div>
                  <div class="storage-text" id="storageText">计算中...</div>
                </div>
                <div class="storage-list" id="storageList"></div>
                <div class="data-hint">
                  <p>💡 <strong>节省空间建议：</strong></p>
                  <ul>
                    <li>使用图片链接代替上传图片</li>
                    <li>定期清理不需要的聊天记录</li>
                    <li>删除不再使用的联系人</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="data-settings-detail" id="backupDetail">
              <div class="settings-card">
                <h3 class="settings-subtitle">💾 数据备份</h3>
                <div class="field">
                  <label>导出备份</label>
                  <p class="field-hint">将所有数据导出为 JSON 文件</p>
                  <button class="btn primary" id="btnExportBackup">📤 导出备份</button>
                </div>
                <div class="field">
                  <label>导入备份</label>
                  <p class="field-hint">从 JSON 文件恢复数据（会覆盖现有数据）</p>
                  <input type="file" id="importBackupInput" accept="application/json" class="file-input" />
                  <button class="btn secondary" id="btnImportBackup">📥 选择文件导入</button>
                </div>
              </div>
            </div>

            <div class="data-settings-detail" id="cleanDetail">
              <div class="settings-card">
                <h3 class="settings-subtitle">🗑️ 清理数据</h3>
                <div class="field">
                  <label>聊天记录</label>
                  <p class="field-hint">清空所有会话和聊天消息</p>
                  <button class="btn ghost" id="btnClearChats">清空聊天记录</button>
                </div>
                <div class="field">
                  <label>动态数据</label>
                  <p class="field-hint">清空所有朋友圈动态</p>
                  <button class="btn ghost" id="btnClearMoments">清空动态数据</button>
                </div>
                <div class="field">
                  <label>所有数据</label>
                  <p class="field-hint">清空所有本地存储数据（不可恢复）</p>
                  <button class="btn danger" id="btnClearAll">清空所有数据</button>
                </div>
              </div>
            </div>
          </div>

          <div class="settings-section sound-settings" id="soundSettings" data-detail="list">
            <div class="sound-settings-main active" id="soundSettingsMain">
              <div class="settings-list">
                <button class="settings-item settings-link" id="uiSoundEntry" aria-label="UI 提示音">
                  <span class="settings-icon icon-bell"></span>
                  <span class="settings-text">UI 提示音</span>
                </button>
                <button class="settings-item settings-link" id="msgSoundEntry" aria-label="消息提示音">
                  <span class="settings-icon icon-bell"></span>
                  <span class="settings-text">消息提示音</span>
                </button>
                <button class="settings-item settings-link" id="musicSoundEntry" aria-label="音乐播放音量">
                  <span class="settings-icon icon-music"></span>
                  <span class="settings-text">音乐播放音量</span>
                </button>
              </div>
            </div>

            <div class="sound-settings-detail" id="uiSoundDetail">
              <div class="settings-card">
                <h3 class="settings-subtitle">UI 提示音</h3>
                <div class="field inline">
                  <div class="field-group">
                    <label for="uiSoundEnable">启用</label>
                    <label class="switch">
                      <input id="uiSoundEnable" type="checkbox" />
                      <span class="slider"></span>
                    </label>
                  </div>
                </div>
                <div class="field">
                  <label for="uiSoundVolume">音量</label>
                  <input id="uiSoundVolume" type="range" min="0" max="1" step="0.01" />
                  <div class="range-value" id="uiSoundVolumeValue">0%</div>
                </div>
                <div class="field">
                  <label for="uiSoundSource">音频选择</label>
                  <select id="uiSoundSource">
                    <option value="default">默认音频</option>
                    <option value="custom">用户上传</option>
                  </select>
                </div>
                <div class="field">
                  <label for="uiSoundFile">上传音频 (mp3 / wav)</label>
                  <input id="uiSoundFile" class="file-input" type="file" accept="audio/mpeg,audio/wav" />
                  <p class="field-hint" id="uiSoundFileHint">未上传时使用默认音频</p>
                </div>
              </div>
            </div>

            <div class="sound-settings-detail" id="msgSoundDetail">
              <div class="settings-card">
                <h3 class="settings-subtitle">消息提示音</h3>
                <div class="field inline">
                  <div class="field-group">
                    <label for="msgSoundEnable">启用</label>
                    <label class="switch">
                      <input id="msgSoundEnable" type="checkbox" />
                      <span class="slider"></span>
                    </label>
                  </div>
                </div>
                <div class="field">
                  <label for="msgSoundVolume">音量</label>
                  <input id="msgSoundVolume" type="range" min="0" max="1" step="0.01" />
                  <div class="range-value" id="msgSoundVolumeValue">0%</div>
                </div>
                <div class="field">
                  <label for="msgSoundSource">音频选择</label>
                  <select id="msgSoundSource">
                    <option value="default">默认音频</option>
                    <option value="custom">用户上传</option>
                  </select>
                </div>
                <div class="field">
                  <label for="msgSoundFile">上传音频 (mp3 / wav)</label>
                  <input id="msgSoundFile" class="file-input" type="file" accept="audio/mpeg,audio/wav" />
                  <p class="field-hint" id="msgSoundFileHint">未上传时使用默认音频</p>
                </div>
              </div>
            </div>

            <div class="sound-settings-detail" id="musicSoundDetail">
              <div class="settings-card">
                <h3 class="settings-subtitle">🎵 音乐播放音量</h3>
                <div class="field">
                  <label for="musicSoundVolume">音量</label>
                  <input id="musicSoundVolume" type="range" min="0" max="1" step="0.01" />
                  <div class="range-value" id="musicSoundVolumeValue">0%</div>
                </div>
                <p class="field-hint">调整音乐播放器的音量大小</p>
              </div>
            </div>
          </div>
        </section>

        <section class="xinliao-view glass" id="xinliaoView">
          <header class="xinliao-nav">
            <button class="xinliao-back" id="xinliaoBack" aria-label="返回">‹</button>
            <div class="xinliao-title">信聊</div>
            <div class="xinliao-nav-right">
              <button class="xinliao-icon-btn xinliao-nav-add" id="xinliaoMessagesAdd" aria-label="新建会话">＋</button>
              <div class="xinliao-dropdown is-hidden" id="xinliaoContactsDropdown">
                <button class="xinliao-icon-btn xinliao-nav-add" id="xinliaoContactsAdd" aria-label="添加联系人">＋</button>
                <div class="xinliao-dropdown-menu is-hidden" id="xinliaoContactsMenu">
                  <button class="xinliao-dropdown-item" id="xinliaoDropdownCreate">
                    <span class="xinliao-dropdown-icon">✏️</span>
                    <span>创建角色</span>
                  </button>
                  <button class="xinliao-dropdown-item" id="xinliaoDropdownImport">
                    <span class="xinliao-dropdown-icon">📁</span>
                    <span>导入文件</span>
                  </button>
                </div>
              </div>
              <button class="xinliao-icon-btn xinliao-nav-add xinliao-camera-btn is-hidden" id="xinliaoMomentsAdd" aria-label="发布动态"></button>
            </div>
          </header>

          <div class="xinliao-panels">
            <section class="xinliao-panel active" id="xinliaoPanel-messages">
              <!-- 删除栏 -->
              <div class="xinliao-delete-bar is-hidden" id="xinliaoDeleteBar">
                <button class="xinliao-delete-cancel" id="xinliaoDeleteCancel">取消</button>
                <span class="xinliao-delete-info">已选择 <span id="xinliaoDeleteCount">0</span> 个</span>
                <button class="xinliao-delete-btn" id="xinliaoDeleteBtn">删除</button>
              </div>
              <div class="xinliao-message-actions is-hidden" id="xinliaoMessageActions">
                <div class="xinliao-action-row">
                  <button class="xinliao-btn secondary" id="xinliaoCreateSingle">新建聊天</button>
                  <button class="xinliao-btn primary" id="xinliaoCreateGroup">新建群聊</button>
                </div>
                <div class="xinliao-form-hint">从联系人选择角色</div>
                <div class="xinliao-message-select" id="xinliaoMessageSelectList"></div>
                <div class="xinliao-field is-hidden">
                  <label for="xinliaoGroupName">群聊名称</label>
                  <input id="xinliaoGroupName" type="text" placeholder="多选后可填写群聊名" />
                </div>
                <div class="xinliao-actions">
                  <button class="xinliao-btn primary is-hidden" id="xinliaoGroupConfirm">确认创建群聊</button>
                  <button class="xinliao-btn" id="xinliaoMessageCancel">收起</button>
                </div>
                <div class="xinliao-form-hint warning is-hidden" id="xinliaoMessageHint"></div>
              </div>
              <div class="xinliao-list" id="xinliaoMessagesList"></div>
            </section>

            <section class="xinliao-panel" id="xinliaoPanel-contacts">
              <!-- 联系人删除栏 -->
              <div class="xinliao-delete-bar is-hidden" id="xinliaoContactsDeleteBar">
                <button class="xinliao-delete-cancel" id="xinliaoContactsDeleteCancel">取消</button>
                <span class="xinliao-delete-info">已选择 <span id="xinliaoContactsDeleteCount">0</span> 个</span>
                <button class="xinliao-batch-move-btn" id="xinliaoContactsBatchMoveBtn">移动</button>
                <button class="xinliao-delete-btn" id="xinliaoContactsDeleteBtn">删除</button>
              </div>
              <div class="xinliao-search">
                <input
                  id="xinliaoContactsSearch"
                  type="text"
                  placeholder="搜索角色"
                  autocomplete="off"
                />
              </div>
              <!-- 新建分组按钮 -->
              <button class="xinliao-new-group-btn" id="xinliaoNewGroupBtn">
                <span class="xinliao-new-group-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                    <line x1="12" y1="8" x2="12" y2="16"/>
                    <line x1="8" y1="12" x2="16" y2="12"/>
                  </svg>
                </span>
                <span class="xinliao-new-group-text">新建分组</span>
              </button>
              <!-- 分组列表 -->
              <div class="xinliao-groups-list" id="xinliaoGroupsList"></div>
              <div class="xinliao-contact-actions is-hidden" id="xinliaoContactActions">
                <div class="xinliao-action-row">
                  <button class="xinliao-btn secondary" id="xinliaoShowCreate">创建角色</button>
                  <button class="xinliao-btn ghost" id="xinliaoShowImport">导入文件</button>
                </div>
                <div class="xinliao-form xinliao-form-create is-hidden" id="xinliaoCreateForm">
                  <div class="xinliao-field">
                    <label for="xinliaoAvatarInput">头像</label>
                    <input id="xinliaoAvatarInput" type="text" placeholder="例如：https://... 或 😀" />
                  </div>
                  <div class="xinliao-field">
                    <label for="xinliaoAvatarFileInput">上传头像图片</label>
                    <input id="xinliaoAvatarFileInput" type="file" accept="image/*" />
                    <div class="xinliao-form-hint">选择图片后会自动填入头像</div>
                  </div>
                  <div class="xinliao-field">
                    <label for="xinliaoNameInput">姓名</label>
                    <input id="xinliaoNameInput" type="text" placeholder="请输入姓名" />
                  </div>
                  <div class="xinliao-field">
                    <label for="xinliaoPersonaInput">具体人设</label>
                    <textarea id="xinliaoPersonaInput" rows="3" placeholder="描述角色性格/背景"></textarea>
                  </div>
                  <button class="xinliao-btn primary" id="xinliaoCreateConfirm">添加角色</button>
                </div>
                <div class="xinliao-form xinliao-form-import is-hidden" id="xinliaoImportForm">
                  <div class="xinliao-field">
                    <label for="xinliaoImportInput">导入角色文件</label>
                    <input id="xinliaoImportInput" type="file" accept="application/json,image/png,.json,.png" />
                  </div>
                  <div class="xinliao-form-hint">支持 JSON 文件或 PNG 角色卡（Character Card）</div>
                </div>
                <div class="xinliao-form-hint warning is-hidden" id="xinliaoContactsHint"></div>
              </div>
              <div class="xinliao-list" id="xinliaoContactsList"></div>
            </section>

            <section class="xinliao-panel" id="xinliaoPanel-moments">
              <!-- 动态背景头部 -->
              <div class="xinliao-moments-header">
                <div class="xinliao-moments-cover" id="xinliaoMomentsCover">
                  <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=400&fit=crop" alt="cover" id="xinliaoMomentsCoverImg" />
                </div>
                <div class="xinliao-moments-user">
                  <span class="xinliao-moments-username" id="xinliaoMomentsUsername">我</span>
                  <div class="xinliao-moments-user-avatar" id="xinliaoMomentsUserAvatar">
                    <span class="xinliao-avatar-text">👤</span>
                  </div>
                </div>
              </div>
              <div class="xinliao-note is-hidden" id="xinliaoMomentsStatus">使用占位数据</div>
              <div class="xinliao-list" id="xinliaoMomentsList"></div>
            </section>

            <!-- 动态发布编辑器 -->
            <div class="xinliao-moments-editor is-hidden" id="xinliaoMomentsEditor">
              <header class="xinliao-editor-header">
                <button class="xinliao-editor-cancel" id="xinliaoMomentsCancel" type="button">取消</button>
                <span class="xinliao-editor-title">发布动态</span>
                <button class="xinliao-editor-publish" id="xinliaoMomentsPublish" type="button">发布</button>
              </header>
              <div class="xinliao-editor-body">
                <textarea 
                  class="xinliao-editor-textarea" 
                  id="xinliaoMomentsContent" 
                  placeholder="这一刻的想法..."
                  rows="4"
                ></textarea>
                <div class="xinliao-editor-images" id="xinliaoMomentsImages"></div>
                <label class="xinliao-editor-add-image">
                  <span class="xinliao-editor-add-icon">🖼️</span>
                  <span>添加图片</span>
                  <input 
                    type="file" 
                    id="xinliaoMomentsImageInput" 
                    class="xinliao-editor-file-input" 
                    accept="image/*" 
                    multiple 
                  />
                </label>
              </div>
            </div>
          </div>

          <div class="xinliao-tabbar" id="xinliaoTabs"></div>

          <!-- 新建分组弹窗 -->
          <div class="xinliao-group-popup" id="xinliaoGroupPopup">
            <div class="xinliao-group-popup-card">
              <div class="xinliao-group-popup-title">新建分组</div>
              <div class="xinliao-group-popup-field">
                <label for="xinliaoNewGroupNameInput">分组名称</label>
                <input type="text" id="xinliaoNewGroupNameInput" placeholder="请输入分组名称" />
              </div>
              <div class="xinliao-group-popup-actions">
                <button class="xinliao-group-popup-btn ghost" id="xinliaoNewGroupCancel">取消</button>
                <button class="xinliao-group-popup-btn primary" id="xinliaoNewGroupConfirm">确定</button>
              </div>
            </div>
          </div>

          <!-- 联系人操作菜单弹窗 -->
          <div class="xinliao-contact-action-popup" id="xinliaoContactActionPopup">
            <div class="xinliao-contact-action-card">
              <div class="xinliao-contact-action-title" id="xinliaoContactActionTitle">操作</div>
              <div class="xinliao-contact-action-list">
                <button class="xinliao-contact-action-item" id="xinliaoContactActionMove">
                  <span class="xinliao-contact-action-icon">📁</span>
                  <span class="xinliao-contact-action-text">移动到分组</span>
                </button>
                <button class="xinliao-contact-action-item danger" id="xinliaoContactActionDelete">
                  <span class="xinliao-contact-action-icon">🗑️</span>
                  <span class="xinliao-contact-action-text">删除联系人</span>
                </button>
              </div>
              <button class="xinliao-contact-action-cancel" id="xinliaoContactActionCancel">取消</button>
            </div>
          </div>

          <!-- 移动到分组弹窗 -->
          <div class="xinliao-move-group-popup" id="xinliaoMoveGroupPopup">
            <div class="xinliao-group-popup-card">
              <div class="xinliao-group-popup-title">移动到分组</div>
              <div class="xinliao-move-group-list" id="xinliaoMoveGroupList">
                <!-- 分组列表将动态生成 -->
              </div>
              <div class="xinliao-group-popup-actions">
                <button class="xinliao-group-popup-btn ghost" id="xinliaoMoveGroupCancel">取消</button>
              </div>
            </div>
          </div>

          <!-- 联系人详情面板 -->
          <div class="xinliao-contact-detail is-hidden" id="xinliaoContactDetail">
            <div class="xinliao-contact-detail-title">角色详情</div>
            <div class="xinliao-form">
              <div class="xinliao-field">
                <label for="xinliaoDetailAvatar">头像</label>
                <input id="xinliaoDetailAvatar" type="text" placeholder="例如：https://... 或 😀" />
              </div>
              <div class="xinliao-field">
                <label for="xinliaoDetailAvatarFile">上传头像图片</label>
                <input id="xinliaoDetailAvatarFile" type="file" accept="image/*" />
                <div class="xinliao-form-hint">选择图片后会自动填入头像</div>
              </div>
              <div class="xinliao-field">
                <label for="xinliaoDetailName">姓名</label>
                <input id="xinliaoDetailName" type="text" placeholder="请输入姓名" />
              </div>
              <div class="xinliao-field">
                <label for="xinliaoDetailPersona">具体人设</label>
                <textarea id="xinliaoDetailPersona" rows="3" placeholder="描述角色性格/背景"></textarea>
              </div>
              <div class="xinliao-field xinliao-worldbook-field">
                <div class="xinliao-worldbook-toggle" id="xinliaoWorldbookToggle">
                  <span class="xinliao-worldbook-toggle-icon">📚</span>
                  <span class="xinliao-worldbook-toggle-text">世界书关联</span>
                  <span class="xinliao-worldbook-toggle-count" id="xinliaoWorldbookCount">0 个</span>
                  <span class="xinliao-worldbook-toggle-arrow">›</span>
                </div>
                <div class="xinliao-worldbook-select is-hidden" id="xinliaoWorldbookSelect">
                  <div class="xinliao-worldbook-list" id="xinliaoWorldbookList"></div>
                  <div class="xinliao-form-hint">选择要关联的世界书分组和设定</div>
                </div>
              </div>
            </div>
            <div class="xinliao-actions">
              <button class="xinliao-btn primary" id="xinliaoDetailSave">保存修改</button>
              <button class="xinliao-btn" id="xinliaoDetailClose">关闭</button>
            </div>
            <div class="xinliao-form-hint warning is-hidden" id="xinliaoDetailHint"></div>
          </div>

          <!-- 聊天界面 -->
          <div class="xinliao-chat is-hidden" id="xinliaoChat">
            <header class="xinliao-chat-header">
              <button class="xinliao-back" id="xinliaoChatBack" aria-label="返回">‹</button>
              <div class="xinliao-chat-header-center">
                <div class="xinliao-chat-header-name" id="xinliaoChatName">聊天</div>
                <div class="xinliao-chat-header-status is-hidden" id="xinliaoChatStatus">正在输入中</div>
              </div>
              <div class="xinliao-chat-header-spacer"></div>
            </header>
            <!-- 消息删除栏 -->
            <div class="xinliao-chat-delete-bar is-hidden" id="xinliaoChatDeleteBar">
              <button class="xinliao-chat-delete-cancel" id="xinliaoChatDeleteCancel">取消</button>
              <span class="xinliao-chat-delete-info">已选择 <span id="xinliaoChatDeleteCount">0</span> 条</span>
              <button class="xinliao-chat-delete-btn" id="xinliaoChatDeleteBtn">删除</button>
            </div>
            <div class="xinliao-chat-messages" id="xinliaoChatMessages"></div>
            <div class="xinliao-chat-input-bar">
              <button class="xinliao-chat-add-btn" type="button" aria-label="更多">＋</button>
              <textarea 
                class="xinliao-chat-input" 
                id="xinliaoChatInput" 
                placeholder="输入消息..." 
                rows="1"
              ></textarea>
              <button class="xinliao-chat-send-btn" id="xinliaoChatSend" type="button">发送</button>
            </div>
          </div>
        </section>

        <!-- 世界书视图 -->
        <section class="worldbook-view glass" id="worldbookView">
          <header class="worldbook-nav">
            <button class="worldbook-back" id="worldbookBack" aria-label="返回">‹</button>
            <div class="worldbook-title">世界书</div>
            <div class="worldbook-nav-right">
              <div class="worldbook-dropdown" id="worldbookDropdown">
                <button class="worldbook-add-btn" id="worldbookAdd" aria-label="添加">＋</button>
                <div class="worldbook-dropdown-menu is-hidden" id="worldbookDropdownMenu">
                  <button class="worldbook-dropdown-item" id="worldbookAddGroup">
                    <span class="worldbook-dropdown-icon">📁</span>
                    <span>新建分组</span>
                  </button>
                  <button class="worldbook-dropdown-item" id="worldbookAddEntry">
                    <span class="worldbook-dropdown-icon">📝</span>
                    <span>新建设定</span>
                  </button>
                  <button class="worldbook-dropdown-item" id="worldbookUpload">
                    <span class="worldbook-dropdown-icon">📤</span>
                    <span>上传文件</span>
                  </button>
                </div>
              </div>
            </div>
          </header>

          <div class="worldbook-content">
            <!-- 未分组提示 -->
            <div class="worldbook-ungrouped-hint is-hidden" id="worldbookUngroupedHint">
              <span class="worldbook-ungrouped-hint-icon">📦</span>
              <span class="worldbook-ungrouped-hint-text">有 <span id="worldbookUngroupedCount">0</span> 个未分组设定，点击批量处理</span>
              <span class="worldbook-ungrouped-hint-arrow">›</span>
            </div>
            <div class="worldbook-groups" id="worldbookGroups"></div>
          </div>

          <!-- 隐藏的文件上传输入 -->
          <input type="file" id="worldbookUploadInput" class="worldbook-file-input" accept=".json,.docx,application/json,application/vnd.openxmlformats-officedocument.wordprocessingml.document" />

          <!-- 新建分组弹窗 -->
          <div class="worldbook-popup" id="worldbookGroupPopup">
            <div class="worldbook-popup-card">
              <div class="worldbook-popup-title">新建分组</div>
              <div class="worldbook-popup-field">
                <label for="worldbookGroupName">分组名称</label>
                <input type="text" id="worldbookGroupName" placeholder="请输入分组名称" />
              </div>
              <div class="worldbook-popup-actions">
                <button class="worldbook-popup-btn ghost" id="worldbookGroupCancel">取消</button>
                <button class="worldbook-popup-btn primary" id="worldbookGroupConfirm">确定</button>
              </div>
            </div>
          </div>

          <!-- 新建设定弹窗 -->
          <div class="worldbook-popup" id="worldbookEntryPopup">
            <div class="worldbook-popup-card">
              <div class="worldbook-popup-title">新建设定</div>
              <div class="worldbook-popup-field">
                <label for="worldbookEntryName">设定名称</label>
                <input type="text" id="worldbookEntryName" placeholder="请输入设定名称" />
              </div>
              <div class="worldbook-popup-field">
                <label for="worldbookEntryContent">设定内容</label>
                <textarea id="worldbookEntryContent" rows="4" placeholder="请输入设定内容"></textarea>
              </div>
              <div class="worldbook-popup-field">
                <label for="worldbookEntryGroup">所属分组</label>
                <select id="worldbookEntryGroup">
                  <option value="">未分组</option>
                </select>
              </div>
              <div class="worldbook-popup-actions">
                <button class="worldbook-popup-btn ghost" id="worldbookEntryCancel">取消</button>
                <button class="worldbook-popup-btn primary" id="worldbookEntryConfirm">确定</button>
              </div>
            </div>
          </div>

          <!-- 分组详情面板 -->
          <div class="worldbook-group-detail" id="worldbookGroupDetail">
            <header class="worldbook-detail-header">
              <button class="worldbook-detail-back" id="worldbookGroupDetailBack">‹</button>
              <div class="worldbook-detail-title" id="worldbookGroupDetailTitle">分组详情</div>
              <div class="worldbook-detail-actions">
                <button class="worldbook-detail-btn rename" id="worldbookGroupDetailRename">重命名</button>
                <button class="worldbook-detail-btn delete" id="worldbookGroupDetailDelete">删除分组</button>
              </div>
            </header>
            <!-- 批量操作工具栏 -->
            <div class="worldbook-group-toolbar">
              <button class="worldbook-group-toolbar-btn" id="worldbookGroupSelectAll">全选</button>
              <select class="worldbook-group-toolbar-select" id="worldbookGroupMoveSelect">
                <option value="">移动到...</option>
              </select>
              <button class="worldbook-group-toolbar-btn delete" id="worldbookGroupBatchDelete" disabled>删除</button>
            </div>
            <div class="worldbook-group-detail-content">
              <div class="worldbook-group-detail-list" id="worldbookGroupDetailList"></div>
            </div>
            <!-- 批量操作底栏 -->
            <div class="worldbook-group-footer is-hidden" id="worldbookGroupFooter">
              <span class="worldbook-group-footer-count">已选择 <span id="worldbookGroupSelectedCount">0</span> 个</span>
            </div>
          </div>

          <!-- 重命名分组弹窗 -->
          <div class="worldbook-popup" id="worldbookRenamePopup">
            <div class="worldbook-popup-card">
              <div class="worldbook-popup-title">重命名分组</div>
              <div class="worldbook-popup-field">
                <label for="worldbookRenameInput">分组名称</label>
                <input type="text" id="worldbookRenameInput" placeholder="请输入新名称" />
              </div>
              <div class="worldbook-popup-actions">
                <button class="worldbook-popup-btn ghost" id="worldbookRenameCancel">取消</button>
                <button class="worldbook-popup-btn primary" id="worldbookRenameConfirm">确定</button>
              </div>
            </div>
          </div>

          <!-- 设定详情面板 -->
          <div class="worldbook-detail" id="worldbookDetail">
            <header class="worldbook-detail-header">
              <button class="worldbook-detail-back" id="worldbookDetailBack">‹</button>
              <div class="worldbook-detail-title" id="worldbookDetailTitle">设定详情</div>
              <div class="worldbook-detail-actions">
                <button class="worldbook-detail-btn delete" id="worldbookDetailDelete">删除</button>
                <button class="worldbook-detail-btn save" id="worldbookDetailSave">保存</button>
              </div>
            </header>
            <div class="worldbook-detail-content">
              <div class="worldbook-detail-field">
                <label for="worldbookDetailName">设定名称</label>
                <input type="text" id="worldbookDetailName" placeholder="请输入设定名称" />
              </div>
              <div class="worldbook-detail-field">
                <label for="worldbookDetailContent">设定内容</label>
                <textarea id="worldbookDetailContent" rows="8" placeholder="请输入设定内容"></textarea>
              </div>
              <div class="worldbook-detail-field">
                <label for="worldbookDetailGroup">所属分组</label>
                <select id="worldbookDetailGroup">
                  <option value="">未分组</option>
                </select>
              </div>
              <div class="worldbook-detail-field worldbook-detail-switch">
                <label for="worldbookDetailEnabled">启用此设定</label>
                <label class="switch">
                  <input type="checkbox" id="worldbookDetailEnabled" checked />
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>

          <!-- 导入弹窗 -->
          <div class="worldbook-popup worldbook-import-popup" id="worldbookImportPopup">
            <div class="worldbook-popup-card">
              <div class="worldbook-popup-title">导入世界书</div>
              <div class="worldbook-import-info" id="worldbookImportInfo">
                <div class="worldbook-import-info-title" id="worldbookImportFileName">文件名</div>
                <div class="worldbook-import-info-count" id="worldbookImportCount">共 0 个设定</div>
              </div>
              <div class="worldbook-popup-field">
                <label for="worldbookImportGroup">导入到分组</label>
                <select id="worldbookImportGroup">
                  <option value="">未分组</option>
                  <option value="__new__">+ 新建分组...</option>
                </select>
              </div>
              <div class="worldbook-popup-field is-hidden" id="worldbookImportNewGroupField">
                <label for="worldbookImportNewGroup">新分组名称</label>
                <input type="text" id="worldbookImportNewGroup" placeholder="请输入新分组名称" />
              </div>
              <div class="worldbook-popup-actions">
                <button class="worldbook-popup-btn ghost" id="worldbookImportCancel">取消</button>
                <button class="worldbook-popup-btn primary" id="worldbookImportConfirm">导入</button>
              </div>
            </div>
          </div>

          <!-- 批量处理面板 -->
          <div class="worldbook-batch-panel" id="worldbookBatchPanel">
            <header class="worldbook-batch-header">
              <button class="worldbook-detail-back" id="worldbookBatchBack">‹</button>
              <div class="worldbook-batch-title">批量处理未分组设定</div>
            </header>
            <div class="worldbook-batch-toolbar">
              <button class="worldbook-batch-select-all" id="worldbookBatchSelectAll">全选</button>
              <select class="worldbook-batch-group-select" id="worldbookBatchGroupSelect">
                <option value="">选择目标分组</option>
              </select>
            </div>
            <div class="worldbook-batch-content">
              <div class="worldbook-batch-list" id="worldbookBatchList"></div>
            </div>
            <div class="worldbook-batch-footer">
              <div class="worldbook-batch-count">已选择 <span id="worldbookBatchCount">0</span> 个</div>
              <button class="worldbook-detail-btn save" id="worldbookBatchMove" disabled>移动到分组</button>
              <button class="worldbook-detail-btn delete" id="worldbookBatchDelete" disabled>删除选中</button>
            </div>
          </div>
        </section>

        <!-- 音乐视图 -->
        <section class="music-view" id="musicView">
          <header class="music-nav">
            <button class="music-back" id="musicBack" aria-label="返回">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 18l-6-6 6-6"/>
              </svg>
            </button>
            <div class="music-header-center">
              <div class="music-title" id="musicSongTitle">暂无歌曲</div>
              <div class="music-subtitle">请搜索或上传歌曲</div>
            </div>
            <button class="music-search-btn" id="musicSearchBtn" aria-label="搜索">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="M21 21l-4.35-4.35"/>
              </svg>
            </button>
          </header>

          <div class="music-content">
            <div class="music-disc-large" id="musicDiscLarge">
              <div class="music-disc-inner">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M9 18V5l12-2v13"/>
                  <circle cx="6" cy="18" r="3"/>
                  <circle cx="18" cy="16" r="3"/>
                </svg>
              </div>
            </div>

          </div>

          <!-- 底部控制区 -->
          <div class="music-bottom">
            <div class="music-progress-area">
              <div class="music-time-row">
                <span class="music-time-current" id="musicTimeCurrent">0:00</span>
                <span class="music-time-total" id="musicTimeTotal">0:00</span>
              </div>
              <div class="music-progress-bar">
                <div class="music-progress-fill" id="musicProgressFill"></div>
              </div>
            </div>

            <div class="music-controls">
              <button class="music-ctrl-btn small" id="musicModeBtn" aria-label="播放模式">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="17 1 21 5 17 9"/>
                  <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                  <polyline points="7 23 3 19 7 15"/>
                  <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
                </svg>
              </button>
              <button class="music-ctrl-btn" id="musicPrevBtn" aria-label="上一首">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="19 20 9 12 19 4 19 20"/>
                  <line x1="5" y1="19" x2="5" y2="5"/>
                </svg>
              </button>
              <button class="music-ctrl-btn play-btn" id="musicPlayBtn" aria-label="播放">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
              </button>
              <button class="music-ctrl-btn" id="musicNextBtn" aria-label="下一首">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5 4 15 12 5 20 5 4"/>
                  <line x1="19" y1="5" x2="19" y2="19"/>
                </svg>
              </button>
              <button class="music-ctrl-btn small" aria-label="列表">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="8" y1="6" x2="21" y2="6"/>
                  <line x1="8" y1="12" x2="21" y2="12"/>
                  <line x1="8" y1="18" x2="21" y2="18"/>
                  <line x1="3" y1="6" x2="3.01" y2="6"/>
                  <line x1="3" y1="12" x2="3.01" y2="12"/>
                  <line x1="3" y1="18" x2="3.01" y2="18"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- 搜索面板 -->
          <div class="music-search-panel" id="musicSearchPanel">
            <header class="music-search-header">
              <button class="music-search-back" id="musicSearchBack" aria-label="返回">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M15 18l-6-6 6-6"/>
                </svg>
              </button>
              <div class="music-search-input-wrap">
                <span class="music-search-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                  </svg>
                </span>
                <input 
                  type="text" 
                  class="music-search-input" 
                  id="musicSearchInput" 
                  placeholder="搜索歌曲、歌手"
                  autocomplete="off"
                />
                <button class="music-search-clear" id="musicSearchClear" aria-label="清除">✕</button>
              </div>
              <button class="music-search-submit" id="musicSearchSubmit">搜索</button>
            </header>

            <div class="music-search-tabs">
              <button class="music-search-tab active" data-tab="local">本地歌曲 (0)</button>
              <button class="music-search-tab" data-tab="online">在线歌曲 (0)</button>
            </div>

            <div class="music-search-content" id="musicSearchContent">
              <div class="music-search-empty">
                <div class="music-search-empty-icon">♪</div>
                <div class="music-search-empty-text">未找到本地歌曲</div>
              </div>
            </div>

            <!-- 本地歌曲上传按钮 -->
            <button class="music-upload-fab" id="musicUploadFab" aria-label="上传本地歌曲">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
              </svg>
            </button>
            <input type="file" id="musicUploadInput" class="music-upload-input" accept="audio/*" multiple />
          </div>
        </section>

        <!-- 家园视图 -->
        <section class="home-garden-view" id="homeGardenView">
          <div class="garden-scene">
            <!-- 简化的房间场景 - 等距视角小房间 -->
            <div class="garden-room-image">
              <img src="assets/images/ChatGPT Image 2026年2月1日 18_48_32.png" alt="家园房间" />
            </div>
            
            <!-- 手机按钮 -->
            <button class="garden-phone-btn" id="gardenPhoneBtn">
              <div class="garden-phone-icon"></div>
              <span class="garden-phone-text">手机</span>
            </button>
          </div>
          
          <!-- 手机界面 -->
          <div class="garden-phone-view" id="gardenPhoneView">
            <div class="phone-frame">
              <div class="phone-top">
                <div class="phone-speaker"></div>
              </div>
              <div class="phone-screen">
                <div class="phone-status-bar">
                  <span class="phone-wifi">📶</span>
                  <div class="phone-battery"></div>
                </div>
                <div class="phone-weather">
                  <div class="phone-sun"></div>
                  <div class="phone-date" id="phoneDate">2月1日</div>
                </div>
                <div class="phone-apps">
                  <div class="phone-app" data-app="mask">
                    <div class="phone-app-icon app-mask">🎭</div>
                    <div class="phone-app-name">面具</div>
                  </div>
                  <div class="phone-app" data-app="asset">
                    <div class="phone-app-icon app-asset">💰</div>
                    <div class="phone-app-name">资产</div>
                  </div>
                  <div class="phone-app" data-app="emoji">
                    <div class="phone-app-icon app-emoji">😊</div>
                    <div class="phone-app-name">表情包</div>
                  </div>
                  <div class="phone-app" data-app="search">
                    <div class="phone-app-icon app-search">🔍</div>
                    <div class="phone-app-name">查手机</div>
                  </div>
                  <div class="phone-app" data-app="home">
                    <div class="phone-app-icon app-home">🏡</div>
                    <div class="phone-app-name">家园</div>
                  </div>
                  <div class="phone-app" data-app="reverse">
                    <div class="phone-app-icon app-reverse">🔎</div>
                    <div class="phone-app-name">反查手机</div>
                  </div>
                  <div class="phone-app" data-app="friend">
                    <div class="phone-app-icon app-friend">🏘️</div>
                    <div class="phone-app-name">好友的家</div>
                  </div>
                  <div class="phone-app" data-app="ikea">
                    <div class="phone-app-icon app-ikea">🛋️</div>
                    <div class="phone-app-name">宜家家居</div>
                  </div>
                  <div class="phone-app" data-app="connect">
                    <div class="phone-app-icon app-connect">🔗</div>
                    <div class="phone-app-name">联机</div>
                  </div>
                </div>
              </div>
              <div class="phone-bottom">
                <button class="phone-home-btn" id="phoneHomeBtn"></button>
              </div>
            </div>
          </div>
        </section>

        <!-- 美化视图 -->
        <section class="beautify-view glass" id="beautifyView">
          <header class="beautify-nav">
            <button class="beautify-back" id="beautifyBack" aria-label="返回">‹</button>
            <div class="beautify-title" id="beautifyTitle">美化</div>
          </header>

          <!-- 主列表 -->
          <div class="beautify-section active" id="beautifyMain">
            <div class="beautify-list">
              <button class="beautify-item" id="beautifyIconEntry">
                <span class="beautify-icon icon-app-icon"></span>
                <span class="beautify-text">图标设置</span>
              </button>
              <button class="beautify-item" id="beautifyWallpaperEntry">
                <span class="beautify-icon icon-wallpaper"></span>
                <span class="beautify-text">设置壁纸</span>
              </button>
              <button class="beautify-item" id="beautifyFontEntry">
                <span class="beautify-icon icon-font"></span>
                <span class="beautify-text">字体设置</span>
              </button>
              <button class="beautify-item" id="beautifyBubbleEntry">
                <span class="beautify-icon icon-bubble"></span>
                <span class="beautify-text">气泡设置</span>
              </button>
              <button class="beautify-item" id="beautifyGlobalEntry">
                <span class="beautify-icon icon-global"></span>
                <span class="beautify-text">全局美化</span>
              </button>
            </div>
          </div>

          <!-- 图标设置主页 -->
          <div class="beautify-section" id="beautifyIconSettings">
            <div class="beautify-list">
              <button class="beautify-item" id="beautifyIconStyleEntry">
                <span class="beautify-icon icon-app-icon"></span>
                <span class="beautify-text">图标风格</span>
              </button>
              <button class="beautify-item" id="beautifyIconCustomEntry">
                <span class="beautify-icon icon-wallpaper"></span>
                <span class="beautify-text">图标设置</span>
              </button>
              <button class="beautify-item" id="beautifyIconOpacityEntry">
                <span class="beautify-icon icon-global"></span>
                <span class="beautify-text">图标透明度</span>
              </button>
            </div>
          </div>

          <!-- 图标风格子页 -->
          <div class="beautify-section" id="beautifyIconStyleSection">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🎨 图标风格</h3>
              <div class="beautify-option-group" id="beautifyIconStyleOptions">
                <div class="beautify-option-item active" data-style="rounded">
                  <span class="beautify-option-label">圆角方形</span>
                  <span class="beautify-option-check"></span>
                </div>
                <div class="beautify-option-item" data-style="circle">
                  <span class="beautify-option-label">圆形</span>
                  <span class="beautify-option-check"></span>
                </div>
                <div class="beautify-option-item" data-style="square">
                  <span class="beautify-option-label">直角方形</span>
                  <span class="beautify-option-check"></span>
                </div>
                <div class="beautify-option-item" data-style="squircle">
                  <span class="beautify-option-label">超椭圆</span>
                  <span class="beautify-option-check"></span>
                </div>
              </div>
              <p class="beautify-hint">修改桌面所有应用图标的形状</p>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">✨ 预览效果</h3>
              <div class="beautify-icon-preview" id="beautifyIconPreview">
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
              </div>
            </div>
            <div class="beautify-card">
              <button class="btn primary" id="beautifyIconStyleConfirm" style="width: 100%;">✓ 确定应用</button>
            </div>
          </div>

          <!-- 图标设置子页（自定义图标） -->
          <div class="beautify-section" id="beautifyIconCustomSection">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">📱 应用图标</h3>
              <p class="beautify-hint">点击图标可替换为自定义图片</p>
              <div class="beautify-icon-grid" id="beautifyIconGrid"></div>
            </div>
            <div class="beautify-card">
              <button class="btn ghost" id="beautifyResetAllIcons" style="width: 100%;">🔄 恢复所有默认图标</button>
            </div>
          </div>

          <!-- 图标透明度子页 -->
          <div class="beautify-section" id="beautifyIconOpacitySection">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">👁️ 图标透明度</h3>
              <div class="beautify-slider-row">
                <input type="range" id="beautifyIconOpacity" min="20" max="100" value="100" />
                <span class="beautify-slider-value" id="beautifyIconOpacityValue">100%</span>
              </div>
              <p class="beautify-hint">调整桌面图标的透明程度（20% - 100%）</p>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">✨ 预览效果</h3>
              <div class="beautify-icon-preview" id="beautifyIconOpacityPreview">
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
                <div class="beautify-icon-preview-item" data-style="rounded"></div>
              </div>
            </div>
            <div class="beautify-card">
              <button class="btn primary" id="beautifyIconOpacityConfirm" style="width: 100%;">✓ 确定应用</button>
            </div>
          </div>

          <!-- 单个图标编辑弹窗 -->
          <div class="beautify-popup" id="beautifyIconEditPopup">
            <div class="beautify-popup-card">
              <div class="beautify-popup-title">编辑图标</div>
              <div class="beautify-popup-icon-preview" id="beautifyEditIconPreview"></div>
              <div class="beautify-popup-field">
                <label for="beautifyIconUrlInput">图片链接</label>
                <input type="text" id="beautifyIconUrlInput" placeholder="https://..." />
              </div>
              <div class="beautify-popup-field">
                <label>或上传图片</label>
                <input type="file" id="beautifyIconFileInput" accept="image/*" class="file-input" />
              </div>
              <div class="beautify-popup-actions">
                <button class="btn ghost" id="beautifyIconEditCancel">取消</button>
                <button class="btn secondary" id="beautifyIconEditReset">恢复默认</button>
                <button class="btn primary" id="beautifyIconEditConfirm">确定</button>
              </div>
            </div>
          </div>

          <!-- 壁纸设置 -->
          <div class="beautify-section" id="beautifyWallpaperSettings">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🖼️ 壁纸预览</h3>
              <div class="beautify-preview" id="beautifyWallpaperPreview">
                <span class="beautify-preview-placeholder">当前壁纸</span>
              </div>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🔗 图片链接</h3>
              <div class="beautify-popup-field">
                <input type="text" id="beautifyWallpaperUrlInput" placeholder="https://..." />
              </div>
              <p class="beautify-hint">输入图片链接后会自动预览</p>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">📤 上传图片</h3>
              <div class="beautify-upload">
                <label class="beautify-upload-btn" id="beautifyWallpaperUpload">
                  <span>📁 选择图片</span>
                </label>
                <input type="file" id="beautifyWallpaperInput" class="beautify-upload-input" accept="image/*" />
              </div>
              <p class="beautify-hint">支持 JPG、PNG 格式</p>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🎨 预设颜色</h3>
              <div class="beautify-color-row">
                <div class="beautify-color-item" data-color="#ffffff" style="background: #ffffff; border: 1px solid #e0e0e0;"></div>
                <div class="beautify-color-item" data-color="linear-gradient(135deg, #667eea, #764ba2)" style="background: linear-gradient(135deg, #667eea, #764ba2);"></div>
                <div class="beautify-color-item" data-color="linear-gradient(135deg, #f093fb, #f5576c)" style="background: linear-gradient(135deg, #f093fb, #f5576c);"></div>
                <div class="beautify-color-item" data-color="linear-gradient(135deg, #4facfe, #00f2fe)" style="background: linear-gradient(135deg, #4facfe, #00f2fe);"></div>
                <div class="beautify-color-item" data-color="linear-gradient(135deg, #43e97b, #38f9d7)" style="background: linear-gradient(135deg, #43e97b, #38f9d7);"></div>
                <div class="beautify-color-item" data-color="linear-gradient(135deg, #fa709a, #fee140)" style="background: linear-gradient(135deg, #fa709a, #fee140);"></div>
                <div class="beautify-color-item" data-color="linear-gradient(135deg, #a8edea, #fed6e3)" style="background: linear-gradient(135deg, #a8edea, #fed6e3);"></div>
              </div>
            </div>
            <div class="beautify-card">
              <button class="btn primary" id="beautifyWallpaperConfirm" style="width: 100%;">✓ 确定应用</button>
            </div>
          </div>

          <!-- 字体设置 -->
          <div class="beautify-section" id="beautifyFontSettings">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">📏 字体大小</h3>
              <div class="beautify-slider-row">
                <input type="range" id="beautifyFontSize" min="12" max="24" value="14" />
                <span class="beautify-slider-value" id="beautifyFontSizeValue">14px</span>
              </div>
              <p class="beautify-hint">调整全局字体大小（12px - 24px）</p>
              <button class="btn primary" id="beautifyFontSizeConfirm" style="width: 100%; margin-top: 0.5em;">✓ 应用字体大小</button>
            </div>
            <div class="beautify-card beautify-collapsible">
              <div class="beautify-collapse-header" id="beautifyFontCustomToggle">
                <h3 class="beautify-subtitle">✏️ 自定义字体</h3>
                <span class="beautify-collapse-arrow">›</span>
              </div>
              <div class="beautify-collapse-content is-hidden" id="beautifyFontCustomContent">
                <div class="beautify-popup-field">
                  <label for="beautifyFontName">字体名称</label>
                  <input type="text" id="beautifyFontName" placeholder="例如：霞鹜文楷" />
                </div>
                <div class="beautify-popup-field">
                  <label for="beautifyFontUrl">字体链接 (可选)</label>
                  <input type="text" id="beautifyFontUrl" placeholder="https://... .woff2 / .ttf" />
                  <p class="beautify-hint">支持 Google Fonts、本地字体文件链接等</p>
                </div>
                <button class="btn primary" id="beautifyFontSave" style="width: 100%;">💾 保存为预设</button>
              </div>
            </div>
            <div class="beautify-card beautify-collapsible">
              <div class="beautify-collapse-header" id="beautifyFontPresetsToggle">
                <h3 class="beautify-subtitle">📚 字体预设</h3>
                <span class="beautify-collapse-arrow">›</span>
              </div>
              <div class="beautify-collapse-content is-hidden" id="beautifyFontPresetsContent">
                <div class="beautify-font-presets" id="beautifyFontPresets">
                  <div class="beautify-font-preset-item active" data-font-id="system">
                    <span class="beautify-font-preset-name">系统默认</span>
                    <span class="beautify-option-check"></span>
                  </div>
                </div>
                <p class="beautify-hint">点击预设切换字体，长按可删除自定义预设</p>
              </div>
            </div>
          </div>

          <!-- 气泡设置 -->
          <div class="beautify-section" id="beautifyBubbleSettings">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">💬 气泡预览</h3>
              <div class="beautify-bubble-preview">
                <div class="beautify-bubble-item left">你好呀~</div>
                <div class="beautify-bubble-item right">嗨，很高兴认识你！</div>
              </div>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🎨 气泡颜色</h3>
              <div class="beautify-color-row">
                <div class="beautify-color-item active" style="background: linear-gradient(135deg, #7da6ff, #5b7bff);"></div>
                <div class="beautify-color-item" style="background: linear-gradient(135deg, #f093fb, #f5576c);"></div>
                <div class="beautify-color-item" style="background: linear-gradient(135deg, #43e97b, #38f9d7);"></div>
                <div class="beautify-color-item" style="background: linear-gradient(135deg, #fa709a, #fee140);"></div>
                <div class="beautify-color-item" style="background: #1a1a2e;"></div>
              </div>
              <p class="beautify-hint">选择发送消息的气泡颜色</p>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">📐 圆角大小</h3>
              <div class="beautify-slider-row">
                <input type="range" id="beautifyBubbleRadius" min="4" max="24" value="16" />
                <span class="beautify-slider-value" id="beautifyBubbleRadiusValue">16px</span>
              </div>
            </div>
          </div>

          <!-- 全局美化 -->
          <div class="beautify-section" id="beautifyGlobalSettings">
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🌈 主题风格</h3>
              <div class="beautify-option-group">
                <div class="beautify-option-item active" data-theme="light">
                  <span class="beautify-option-label">浅色模式</span>
                  <span class="beautify-option-check"></span>
                </div>
                <div class="beautify-option-item" data-theme="dark">
                  <span class="beautify-option-label">深色模式</span>
                  <span class="beautify-option-check"></span>
                </div>
                <div class="beautify-option-item" data-theme="auto">
                  <span class="beautify-option-label">跟随系统</span>
                  <span class="beautify-option-check"></span>
                </div>
              </div>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">✨ 毛玻璃效果</h3>
              <div class="beautify-slider-row">
                <input type="range" id="beautifyBlur" min="0" max="20" value="10" />
                <span class="beautify-slider-value" id="beautifyBlurValue">10px</span>
              </div>
              <p class="beautify-hint">调整界面的模糊程度</p>
            </div>
            <div class="beautify-card">
              <h3 class="beautify-subtitle">🔆 透明度</h3>
              <div class="beautify-slider-row">
                <input type="range" id="beautifyOpacity" min="50" max="100" value="80" />
                <span class="beautify-slider-value" id="beautifyOpacityValue">80%</span>
              </div>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
